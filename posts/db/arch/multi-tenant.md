---
title: 多租户数据存储
date: 2025-06-25T02:23:52.269Z
category:
  - db
  - arch
  - multi-tenant
tags:
  - db
  - arch
  - multi-tenant
---

# 多租户数据存储
[[toc]]

## 什么是多租户

多租户技术（multi-tenancy technology）是一种软件架构技术，可以让多个租户共享同一个系统或程序组件，并且仍可确保各用户间数据的隔离性。

## 多租户数据存储实现方式

多租户架构在数据存储层面主要有三种实现方式，各有优缺点和适用场景：

## 1. 独立数据库模式
- **描述**：每个租户拥有完全独立的数据库实例
- **优点**：
  - 数据完全隔离，安全性最高
  - 可针对不同租户进行定制化优化
  - 故障影响范围小
- **缺点**：
  - 硬件资源消耗大
  - 维护成本高
  - 升级迁移复杂
- **适用场景**：对数据隔离要求极高的大型企业客户

## 2. 共享数据库，独立Schema
- **描述**：同一数据库实例，不同租户使用不同Schema
- **优点**：
  - 较好的数据隔离性
  - 资源利用率较高
  - 维护成本相对较低
- **缺点**：
  - 跨租户查询复杂
  - 单个租户数据量大时可能影响性能
  - 如果出现故障，数据恢复比较困难
- **适用场景**：中等规模SaaS应用
::: tip
在数据库和数据存储领域，Schema（模式/架构） 是指数据库的逻辑结构定义，它描述了数据的组织方式，包括：
- 表（Tables） 及其字段（Columns）
- 数据类型（Data Types）（如整数、字符串、日期等）
- 约束（Constraints）（如主键、外键、唯一性约束）
- 索引（Indexes）
- 视图（Views） 
- 存储过程（Stored Procedures）
- 权限（Permissions）
:::
  
::: tip
SaaS（Software as a Service，软件即服务） 是一种通过互联网提供软件服务的模式。用户无需本地安装和维护软件，而是直接通过浏览器或客户端访问云端应用，按需订阅使用。
:::

## 3. 共享数据库，共享Schema
- **描述**：所有租户共享相同的数据库和表结构，通过租户ID字段区分
- **优点**：
  - 资源利用率最高
  - 维护最简单
  - 扩展性好
- **缺点**：
  - 数据隔离性最差
  - 需要应用层严格控制数据访问
  - 单个租户性能问题可能影响整体
  - 数据备份和恢复最困难，需要逐表逐条备份和还原。
- **适用场景**：小型SaaS应用或对隔离要求不高的场景

## 4. 混合模式
- **描述**：结合上述多种方式，如重要客户用独立数据库，普通客户用共享模式
- **优点**：
  - 灵活满足不同需求
  - 资源分配更合理
- **缺点**：
  - 架构复杂
  - 实现和维护难度大
  
现代云数据库服务(如AWS RDS多租户功能、Azure SQL数据库弹性池)也提供了多租户支持的基础设施解决方案。